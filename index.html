<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Flow - Your Life OS</title>
    <style>
        /* --- GLOBAL STYLES & PLATFORM SHELL --- */
        :root {
            --primary: #4f46e5; --secondary: #10b981; --light: #f9fafb; --dark: #1f2937; --gray: #6b7280; --border-color: #e5e7eb;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--light); color: var(--dark); text-align: center; }
        .habit-flow-app { max-width: 900px; margin: 0 auto; padding: 1rem; }
        .screen { display: none; }
        .screen.active { display: block; }
        h1 { color: var(--primary); margin-bottom: 0.5rem; }
        h2 { font-size: 1.5rem; color: var(--dark); margin-top: 1.5rem; margin-bottom: 1rem; text-align: left; }
        p { color: var(--gray); line-height: 1.6; text-align: left; }
        .btn { background-color: var(--primary); color: white; border: none; padding: 1rem 1.5rem; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; width: 100%; }
        .btn:hover { background-color: #4338ca; }

        /* Login Screen */
        #login-screen { padding-top: 5rem; }
        #login-screen input { width: 100%; max-width: 400px; padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color); font-size: 1.1rem; text-align: center; margin: 2rem 0; }
        #login-error { color: #ef4444; height: 1.5rem; }

        /* Main Content Shell */
        #main-header { padding: 1.5rem 0; border-bottom: 1px solid var(--border-color); margin-bottom: 2rem; }
        #back-to-dashboard-btn { background: none; border: none; color: var(--primary); font-size: 1rem; font-weight: 600; cursor: pointer; display: none; }
        #main-footer { margin-top: 4rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color); font-size: 0.9rem; color: var(--gray); }

        /* Dashboard */
        #dashboard-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem; }
        .app-card { background: white; padding: 2rem 1.5rem; border-radius: 12px; border: 1px solid var(--border-color); box-shadow: 0 4px 12px rgba(0,0,0,0.05); cursor: pointer; transition: all 0.2s ease-in-out; }
        .app-card:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.08); border-color: var(--primary); }
        .app-card .icon { font-size: 2.5rem; }
        .app-card h3 { margin-top: 1rem; font-size: 1.1rem; }

        /* --- MINI-APP GENERAL & SCOPED STYLES --- */
        .mini-app-container .section-card { background: white; padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border-color); margin-bottom: 1.5rem; text-align: left; }
        .mini-app-container .btn-upgrade { background-color: var(--secondary); margin-top: 1.5rem; }
        .mini-app-container .btn-upgrade:hover { background-color: #059669; }
        .mini-app-container .input-group { display: flex; flex-direction: column; }
        .mini-app-container .input-group label { font-weight: 500; margin-bottom: 0.5rem; font-size: 1rem; }
        .mini-app-container .input-group input, .mini-app-container .input-group select, .mini-app-container .input-group textarea { font-size: 1.1rem; padding: 0.8rem; border-radius: 8px; border: 1px solid var(--border-color); width: 100%; font-family: inherit; }
        .sponsor-section { background-color: #f3f4f6; border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; margin-top: 2.5rem; text-align: left; }
        .sponsor-section h3 { color: var(--dark); font-size: 1.2rem; }
        .sponsor-section a { color: var(--primary); font-weight: 600; text-decoration: none; }
        .special-offer-text { font-weight: 700; margin-top: 1rem; display: block; }
        .upgrade-pitch p { text-align: center; }
        .mini-app-container .trial-banner { background-color: #e0e7ff; color: var(--primary); padding: 0.5rem 1rem; border-radius: 99px; font-size: 0.9rem; font-weight: 500; margin: 0.5rem auto 1.5rem; display: inline-block; }

        /* Breathing App */
        #app-breathing #breather { width: 250px; height: 250px; border-radius: 50%; background-color: #e0e7ff; margin: 2rem auto; display: flex; justify-content: center; align-items: center; }
        #app-breathing #breather.breathing { animation: hf-breathe-animation 12s infinite ease-in-out; }
        @keyframes hf-breathe-animation { 0% { transform: scale(1); } 33% { transform: scale(1.2); } 66% { transform: scale(1.2); } 100% { transform: scale(1); } }
        
        /* Journal App */
        #app-journal .mood-selector { display: flex; gap: 0.5rem; justify-content: center; margin-bottom: 1.5rem; }
        #app-journal .mood-btn { flex: 1; background-color: #fff; border: 1px solid var(--border-color); padding: 0.6rem; border-radius: 8px; cursor: pointer; }
        #app-journal .mood-btn.active { background-color: #e0e7ff; color: var(--primary); border-color: var(--primary); }
        #app-journal #prompt-display { background-color: #fff; border: 1px solid var(--border-color); border-radius: 8px; padding: 2rem 1.5rem; min-height: 150px; display: flex; justify-content: center; align-items: center; margin-top: 1.5rem; }
        #app-journal #prompt-text { font-size: 1.2rem; font-style: italic; }
        #app-journal .log-entry { padding: 0.75rem 0.25rem; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; }
        #app-journal .btn-delete { background-color: #ef4444; font-size: 0.8rem; padding: 0.5rem 1rem; width: auto; }
        
        /* Subscription Tracker */
        #app-subs .summary { background-color: #0d47a1; color: white; border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; }
        #app-subs #total-cost { font-size: 2.5rem; font-weight: 700; }
        #app-subs .add-form { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; }
        #app-subs .sub-item { display: flex; align-items: center; justify-content: space-between; padding: 1rem; border-bottom: 1px solid var(--border-color); }
        #app-subs #currency-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; display: none; justify-content: center; align-items: center; }
        #app-subs .currency-content { background: white; padding: 2rem; border-radius: 12px; max-width: 400px; width: 90%; }
        #app-subs .btn-delete { background-color: #f3f4f6; color: #ef4444; width: auto; font-size: 1.2rem; padding: 0.3rem 0.6rem; border: 1px solid var(--border-color); }
        #app-subs .currency-symbol { padding: 0.8rem 0 0.8rem 0.8rem; border: 1px solid var(--border-color); border-right: none; border-radius: 8px 0 0 8px; background-color: #f3f4f6; }
        #app-subs #sub-amount { border-left: none; border-radius: 0; }
        
        /* Chore App */
        #app-chores .chore-item { display: flex; flex-direction: column; padding: 1rem; border-bottom: 1px solid var(--border-color); }
        @media (min-width: 600px) { #app-chores .chore-item { flex-direction: row; align-items: center; justify-content: space-between; } }
        #app-chores .chore-name { font-size: 1.2rem; font-weight: 600; }
        #app-chores .chore-tag { background-color: #f3f4f6; color: var(--gray); font-size: 0.8rem; padding: 0.2rem 0.6rem; border-radius: 12px; display: inline-block; margin-top: 0.5rem; }
        #app-chores #reward-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; display: none; justify-content: center; align-items: center; }
        #app-chores .reward-content { background: white; padding: 3rem 2rem; border-radius: 12px; }

        /* Declutter App */
        #app-declutter .progress-bar-container { background-color: var(--border-color); border-radius: 99px; overflow: hidden; }
        #app-declutter #progress-bar { height: 12px; background-color: #8b5cf6; transition: width 0.5s; }
        #app-declutter #challenge-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
        #app-declutter .day-card { padding: 1rem; border-radius: 12px; border: 1px solid var(--border-color); }
        #app-declutter .day-card.completed { background-color: #f3f4f6; opacity: 0.7; }
        #app-declutter .day-card.locked { background-color: #f3f4f6; cursor: pointer; opacity: 0.5; }

        /* Health App */
        #app-health .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        #app-health .input-group input.input-warning { border: 2px solid #ef4444; }
        #app-health .warning-text { color: #ef4444; font-size: 0.8rem; height: 1.2rem; text-align: left; }
        #app-health .med-chart { border-collapse: collapse; width: 100%; margin-top: 1rem; }
        #app-health .med-chart th, #app-health .med-chart td { padding: 0.8rem; border: 1px solid var(--border-color); text-align: center; }
        #app-health .med-checklist label { display: flex; align-items: center; font-size: 1.1rem; margin-bottom: 0.5rem; }
        #app-health .med-checklist input[type="checkbox"] { width: 20px; height: 20px; margin-right: 1rem; }
        
        /* Gratitude App */
        #app-gratitude .prompt-group textarea { width: 100%; margin-top: 0.5rem; padding: 1rem; font-size: 1.1rem; border-radius: 8px; border: 1px solid var(--border-color); min-height: 80px; }
        #app-gratitude .history-item blockquote { border-left: 3px solid #10b981; padding-left: 1rem; margin: 0.5rem 0; font-style: italic; }
    </style>
</head>
<body>
    <div class="habit-flow-app">
        <div id="login-screen" class="screen active">
            <h1>Welcome to Habit Flow</h1>
            <p style="text-align:center;">Your personal OS for a better life. Enter the password to begin.</p>
            <input type="password" id="password-input" placeholder="••••••••">
            <p id="login-error"></p>
            <button id="login-btn" class="btn">Start 7-Day Trial</button>
        </div>

        <div id="main-content" style="display: none;">
            <header id="main-header">
                <button id="back-to-dashboard-btn">&larr; Back to Dashboard</button>
                <h1 id="app-title">Dashboard</h1>
            </header>
            <main>
                <div id="dashboard-screen" class="screen">
                    <div id="dashboard-grid"></div>
                </div>
                <div id="app-gratitude" class="screen mini-app-container"></div>
                <div id="app-journal" class="screen mini-app-container"></div>
                <div id="app-breathing" class="screen mini-app-container"></div>
                <div id="app-subs" class="screen mini-app-container"></div>
                <div id="app-chores" class="screen mini-app-container"></div>
                <div id="app-declutter" class="screen mini-app-container"></div>
                <div id="app-health" class="screen mini-app-container"></div>
            </main>
            <footer id="main-footer">
                <p style="text-align:center;">Every upgrade results in $1 being forwarded to TCF & Edhi.</p>
                <p style="text-align:center; margin-top: 0.5rem;">2025 - Habit Flow - A Self-Help Initiative by Farhan Nadeem.</p>
            </footer>
        </div>
    </div>
    
    <script>
        // MASTER SCRIPT FOR HABIT FLOW PLATFORM
        document.addEventListener('DOMContentLoaded', () => {
            const App = {
                password: 'flow2025',
                initializedApps: new Set(),
                
                miniApps: {
                    gratitude: { title: 'Gratitude Journal', icon: '🙏', init: initGratitudeApp },
                    journal: { title: 'AI Journal Prompts', icon: '💡', init: initJournalApp },
                    breathing: { title: 'Breathing Exercise', icon: '🧘', init: initBreathingApp },
                    subs: { title: 'Subscription Tracker', icon: '💸', sponsor: { name: 'TheLendHub.com', url: 'https://thelendehub.com'}, init: initSubsApp },
                    chores: { title: 'Kids\' Chore App', icon: '👨‍👩‍👧‍👦', sponsor: { name: 'Giggle Grades', url: 'https://gigglegrades.com'}, init: initChoresApp },
                    declutter: { title: 'Declutter Challenge', icon: '🧹', sponsor: { name: 'Refer King HQ', url: 'https://referkinghq.com'}, init: initDeclutterApp },
                    health: { title: 'Health History Log', icon: '❤️', sponsor: { name: 'Healants.com', url: 'https://www.healants.com'}, init: initHealthApp }
                },

                elements: {},
                
                init() {
                    this.elements = {
                        loginScreen: document.getElementById('login-screen'),
                        mainContent: document.getElementById('main-content'),
                        dashboardGrid: document.getElementById('dashboard-grid'),
                        appTitle: document.getElementById('app-title'),
                        backBtn: document.getElementById('back-to-dashboard-btn'),
                        loginBtn: document.getElementById('login-btn'),
                        passwordInput: document.getElementById('password-input'),
                        loginError: document.getElementById('login-error')
                    };
                    this.injectAllHTML();
                    this.addEventListeners();
                },

                addEventListeners() {
                    this.elements.loginBtn.addEventListener('click', () => this.handleLogin());
                    this.elements.passwordInput.addEventListener('keypress', (e) => e.key === 'Enter' && this.handleLogin());
                    this.elements.backBtn.addEventListener('click', () => this.showDashboard());
                    this.elements.dashboardGrid.addEventListener('click', (e) => {
                        const card = e.target.closest('.app-card');
                        if (card) this.showMiniApp(card.dataset.appId);
                    });
                },
                
                showScreen(screenId) {
                    document.querySelectorAll('#main-content .screen').forEach(s => s.classList.remove('active'));
                    const screen = document.getElementById(screenId);
                    if (screen) screen.classList.add('active');
                },
                
                handleLogin() {
                    if (this.elements.passwordInput.value === this.password) {
                        this.elements.loginScreen.style.display = 'none';
                        this.elements.mainContent.style.display = 'block';
                        this.renderDashboard();
                        this.showDashboard();
                    } else {
                        this.elements.loginError.textContent = 'Incorrect password.';
                    }
                },

                renderDashboard() {
                    this.elements.dashboardGrid.innerHTML = '';
                    for (const appId in this.miniApps) {
                        const app = this.miniApps[appId];
                        const card = document.createElement('div');
                        card.className = 'app-card';
                        card.dataset.appId = appId;
                        card.innerHTML = `<div class="icon">${app.icon}</div><h3>${app.title}</h3>`;
                        this.elements.dashboardGrid.appendChild(card);
                    }
                },

                showDashboard() {
                    this.elements.appTitle.textContent = 'Dashboard';
                    this.elements.backBtn.style.display = 'none';
                    this.showScreen('dashboard-screen');
                },

                showMiniApp(appId) {
                    const app = this.miniApps[appId];
                    if (app) {
                        this.elements.appTitle.textContent = app.title;
                        this.elements.backBtn.style.display = 'block';
                        this.showScreen(`app-${appId}`);
                        if (!this.initializedApps.has(appId)) {
                            app.init();
                            this.initializedApps.add(appId);
                        }
                    }
                },
                
                injectAllHTML() {
                    const inject = (id, html) => document.getElementById(id).innerHTML = html;
                    inject('app-gratitude', `
                        <div class="section-card"><h2>New Entry</h2><div class="prompt-group"><label for="grateful-input">Today, I am grateful for...</label><textarea id="grateful-input" placeholder="A small detail or a big event..."></textarea></div><div class="prompt-group"><label for="amazing-input">One amazing thing that happened today was...</label><textarea id="amazing-input" placeholder="Something that made you smile..."></textarea></div><div class="prompt-group"><label for="forward-input">I am looking forward to...</label><textarea id="forward-input" placeholder="Something exciting on the horizon..."></textarea></div><button id="save-entry-btn-gratitude" class="btn">Save Today's Entry</button></div>
                        <div class="section-card"><h2>Your Journal</h2><div id="history-log-gratitude"></div></div>
                        <div class="upgrade-pitch"><p>Upgrade to keep your journal history forever.</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div>
                    `);
                    inject('app-journal', `
                        <p style="text-align:center;">Select a mood, then generate a unique prompt.</p><div class="mood-selector"><button class="mood-btn active" data-mood="reflective">Reflective</button><button class="mood-btn" data-mood="motivated">Motivated</button><button class="mood-btn" data-mood="anxious">Anxious</button></div><button id="generate-prompt-btn-journal" class="btn">✨ Give Me a Prompt</button><div id="prompt-display"><p id="prompt-text">Your personal prompt will appear here...</p></div>
                        <div class="section-card" style="margin-top: 2rem;"><div style="display:flex; justify-content: space-between; align-items: center;"><h2>Your Prompt History</h2><button id="delete-btn-journal" class="btn btn-delete">Remove Selected</button></div><div id="history-log-journal"></div></div>
                        <div class="upgrade-pitch"><p>Upgrade for unlimited prompts and history.</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div>
                    `);
                    inject('app-breathing', `
                        <div class="section-card"><h2>Breathing Exercise</h2><div id="breather"><p id="breather-text">Start</p></div><button id="start-btn-breathing" class="btn">Begin Exercise</button><div class="upgrade-pitch" style="margin-top:2rem;"><p style="text-align:center;">Upgrade for more breathing patterns and guided sessions.</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div></div>
                    `);
                    inject('app-subs', `
                        <div class="trial-banner" id="trial-banner-subs">Day 1 of 7</div><div class="summary"><p>Your Estimated Monthly Total</p><div id="total-cost">$0.00</div></div><div class="section-card"><h2>Add a New Bill</h2><div class="add-form"><span class="currency-symbol" id="form-currency-symbol">$</span><input type="text" id="sub-name" placeholder="e.g., Netflix..."><input type="number" id="sub-amount" placeholder="Amount" min="0" step="0.01"><button id="add-btn-subs" class="btn">+</button></div></div><div class="section-card"><h2>Your Subscriptions</h2><div id="sub-list"></div></div>
                        <div class="sponsor-section"><h3>Sponsored by TheLendHub.com</h3><p>Providing free business loan underwriting services. <a href="https://thelendehub.com" target="_blank">Visit TheLendHub.com</a>.</p><span class="special-offer-text">Special Offer:</span><p>Share a business prospect with us. If we provide them a loan, you receive 10% of our profit!</p></div>
                        <div class="upgrade-pitch"><p>Upgrade to receive free, personalized financial solutions.</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div><div id="currency-modal"><div class="currency-content"><h2>Select Your Currency</h2><select id="currency-select"><option value="$">USD ($)</option><option value="CAD">CAD (C$)</option><option value="AED">AED (د.إ)</option><option value="PKR">PKR (₨)</option><option value="INR">INR (₹)</option><option value="£">GBP (£)</option><option value="€">EUR (€)</option></select><button id="save-currency-btn-subs" class="btn">Save and Continue</button></div></div>
                    `);
                    inject('app-chores', `
                        <div class="section-card"><h2>Add a New Chore</h2><div class="add-chore-form" style="display:grid; grid-template-columns: 1fr; gap:1rem;"><div class="input-group"><label for="chore-name-input">Chore Name</label><input type="text" id="chore-name-input" placeholder="e.g., Make the bed"></div><div class="input-group"><label for="chore-reward-input">Reward</label><input type="text" id="chore-reward-input" placeholder="e.g., 1 Star"></div><div class="input-group"><label for="chore-freq-select">Frequency</label><select id="chore-freq-select"><option value="Daily">Daily</option><option value="Weekly">Weekly</option></select></div><button id="add-chore-btn" class="btn">Add Chore</button></div></div>
                        <div class="section-card"><h2>Chore List</h2><div id="chore-list-container"></div></div><div class="section-card"><h2>Completion History</h2><div id="history-log-chores"></div></div>
                        <div class="sponsor-section"><h3>Sponsored by Giggle Grades</h3><p>Making learning fun. Visit <a href="https://gigglegrades.com/" target="_blank">gigglegrades.com</a>.</p><span class="special-offer-text">Special Offer:</span><p>Refer a school or learning center. If they sign up, you receive a special bonus!</p></div>
                        <div class="upgrade-pitch"><p>Upgrade to save history beyond the trial.</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div><div id="reward-modal"><div class="reward-content"><h3>🎉 Reward Earned! 🎉</h3><p id="reward-text"></p></div></div>
                    `);
                    inject('app-declutter', `
                        <div class="section-card"><h2>Your Progress</h2><div class="progress-bar-container"><div id="progress-bar"></div></div><p id="progress-text">0/30 Days Complete</p></div><div class="section-card"><h2>The Challenge <span style="font-size: 0.9rem; color: var(--gray);">(First 7 Days Free!)</span></h2><div id="challenge-grid"></div></div>
                        <div class="sponsor-section"><h3>Sponsored by Refer King HQ</h3><p>Unlock the power of referrals. Visit <a href="https://referkinghq.com/" target="_blank">referkinghq.com</a>.</p><span class="special-offer-text">Special Offer:</span><p>Refer a new client. If they sign up, you get a bonus commission!</p></div>
                        <div class="upgrade-pitch"><p>Upgrade to unlock the full 30-day challenge!</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div><div id="reward-modal-declutter" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:1000; justify-content:center; align-items:center;"><div class="reward-content" style="background:white; padding:2rem; border-radius:12px;"><h3>✨ Well Done! ✨</h3><p id="reward-text-declutter"></p></div></div>
                    `);
                    inject('app-health', `
                        <div class="section-card"><h2>Step 1: Manage Your Medications</h2><div class="med-form"><input type="text" id="med-name-input-add" class="input-group" placeholder="e.g., Metformin 500mg"><button id="add-med-btn-health" class="btn">Add</button></div><div id="med-list-container"></div></div>
                        <div class="section-card"><h2>Step 2: Add a New Record</h2><p>Enter your vitals and check which medications you've just taken.</p><div class="input-grid" style="margin-top: 1rem;"><div class="input-group"><label for="sugar-input">Blood Sugar (mg/dL)</label><input type="number" id="sugar-input" placeholder="e.g., 110"><p class="warning-text" id="sugar-warning"></p></div><div class="input-group"><label for="bp-input">Blood Pressure</label><input type="text" id="bp-input" placeholder="e.g., 120/80"><p class="warning-text" id="bp-warning"></p></div><div class="input-group"><label for="hr-input">Heart Rate (BPM)</label><input type="number" id="hr-input" placeholder="e.g., 70"><p class="warning-text" id="hr-warning"></p></div><div class="input-group"><label for="temp-input">Temperature (°F)</label><input type="number" id="temp-input" step="0.1" placeholder="e.g., 98.6"><p class="warning-text" id="temp-warning"></p></div></div><div id="med-checklist-container" class="med-checklist"></div></div>
                        <button id="save-log-btn-health" class="btn">Add New Record</button><div class="section-card" style="margin-top: 2rem;"><h2>Your Recorded History</h2><div id="history-log-health"></div></div>
                        <div class="sponsor-section"><h3>Sponsored by Healants.com</h3><p>Your partner in wellness. Visit <a href="https://www.healants.com" target="_blank">www.healants.com</a>.</p><span class="special-offer-text">Special Offer:</span><p>Refer a clinic. If they partner with us, you receive a special bonus!</p><p class="disclaimer" style="font-size:0.8rem; font-style:italic; margin-top:1rem;"><strong>Disclaimer:</strong> This is a recording tool only, not medical advice.</p></div>
                        <div class="upgrade-pitch"><p>Upgrade to save your history beyond the trial.</p><button class="btn btn-upgrade" onclick="alert('Upgrade feature coming soon!')">Upgrade for $5/mo</button></div>
                    `);
                }
            };
            
            // --- The "Brains" for each App (fully implemented) ---
            function initGratitudeApp(){const e=document.getElementById("app-gratitude"),t=e.querySelector("#grateful-input"),n=e.querySelector("#amazing-input"),o=e.querySelector("#forward-input"),r=e.querySelector("#save-entry-btn-gratitude"),i=e.querySelector("#history-log-gratitude");let a=JSON.parse(localStorage.getItem("habitFlowGratitudeLog")||"[]");function d(){i.innerHTML="",0===a.length?i.innerHTML='<p style="text-align:center; color: var(--gray);">Your saved entries will appear here.</p>':a.slice().reverse().forEach(e=>{const t=document.createElement("div");t.className="history-item";let n=`<div class="history-date">${new Date(e.timestamp).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}</div>`;e.gratefulFor&&(n+=`<div><label>Grateful for:</label><blockquote>${e.gratefulFor}</blockquote></div>`),e.amazingThing&&(n+=`<div><label>Amazing thing:</label><blockquote>${e.amazingThing}</blockquote></div>`),e.lookingForwardTo&&(n+=`<div><label>Looking forward to:</label><blockquote>${e.lookingForwardTo}</blockquote></div>`),t.innerHTML=n,i.appendChild(t)})}r.addEventListener("click",()=>{const e={timestamp:Date.now(),gratefulFor:t.value.trim(),amazingThing:n.value.trim(),lookingForwardTo:o.value.trim()};e.gratefulFor||e.amazingThing||e.lookingForwardTo?(a.push(e),localStorage.setItem("habitFlowGratitudeLog",JSON.stringify(a)),[t,n,o].forEach(e=>e.value=""),d(),alert("Your entry has been saved!")):alert("Please fill out at least one field.")}),d()}
            function initJournalApp(){const e=document.getElementById("app-journal"),t=e.querySelectorAll(".mood-btn"),n=e.querySelector("#generate-prompt-btn-journal"),o=e.querySelector("#prompt-text"),r=e.querySelector("#history-log-journal"),i=e.querySelector("#delete-btn-journal");let a="reflective",d=JSON.parse(localStorage.getItem("habitFlowJournalLog_v2")||"[]");const l={reflective:["What's a small moment from today that you're grateful for?","Describe a recent challenge and what it taught you.","If you could give your younger self one piece of advice, what would it be?"],motivated:["What is one small step you can take today towards a big goal?","Describe the feeling you want when you accomplish your next goal.","What skill do you want to develop?"],anxious:["Write down a worry. What part of it can you control?","Describe a place where you feel completely calm.","What is one thing you can do now to be kind to yourself?"]};function s(){r.innerHTML="",0===d.length?(r.innerHTML='<p style="text-align:center;">Your generated prompts will appear here.</p>',i.style.display="none"):(i.style.display="inline-block",d.slice().reverse().forEach(e=>{const t=document.createElement("div");t.className="log-entry",t.innerHTML=`<input type="checkbox" data-id="${e.id}" style="margin-right:1rem;"><div><p style="font-size: 0.8rem; color: var(--gray);">${new Date(e.timestamp).toLocaleString()}</p><p>${e.prompt}</p></div>`,r.appendChild(t)}))}t.forEach(n=>n.addEventListener("click",e=>{a=e.target.dataset.mood,t.forEach(e=>e.classList.remove("active")),e.target.classList.add("active")})),n.addEventListener("click",()=>{const e=l[a],t=e[Math.floor(Math.random()*e.length)];o.textContent=t,d.push({id:Date.now(),timestamp:Date.now(),prompt:t}),localStorage.setItem("habitFlowJournalLog_v2",JSON.stringify(d)),s()}),i.addEventListener("click",()=>{const t=Array.from(e.querySelectorAll('input:checked')).map(e=>parseInt(e.dataset.id));0!==t.length?(d=d.filter(e=>!t.includes(e.id)),localStorage.setItem("habitFlowJournalLog_v2",JSON.stringify(d)),s()):alert("Please select prompts to delete.")}),s()}
            function initBreathingApp(){const e=document.getElementById("app-breathing"),t=e.querySelector("#start-btn-breathing"),n=e.querySelector("#breather"),o=e.querySelector("#breather-text");let r=!1,i;t.addEventListener("click",()=>{r=!r,r?(t.textContent="Stop Exercise",n.classList.add("breathing"),function e(t){o.textContent=t}("Breathe In..."),setTimeout(()=>o.textContent="Hold",4e3),setTimeout(()=>o.textContent="Breathe Out...",8e3),i=setInterval(()=>{o.textContent="Breathe In...",setTimeout(()=>o.textContent="Hold",4e3),setTimeout(()=>o.textContent="Breathe Out...",8e3)},12e3)):(t.textContent="Begin Exercise",n.classList.remove("breathing"),o.textContent="Start",clearInterval(i))})}
            function initSubsApp(){const e=document.getElementById("app-subs"),t=e.querySelector("#add-btn-subs"),n=e.querySelector("#total-cost"),o=e.querySelector("#sub-list"),r=e.querySelector("#currency-modal"),i=e.querySelector("#save-currency-btn-subs"),a=e.querySelector("#form-currency-symbol");let d=[],l="$";function s(){let e=d.reduce((e,t)=>e+t.amount,0);n.textContent=`${l}${e.toFixed(2)}`,a.textContent=l,o.innerHTML="",d.forEach(e=>{o.innerHTML+=`<div class="sub-item"><span>${e.name}</span><div><span>${l}${e.amount.toFixed(2)}</span> <button class="btn-delete" data-id="${e.id}">&times;</button></div></div>`})}localStorage.getItem("habitFlowSubsCurrency_v1")?(l=localStorage.getItem("habitFlowSubsCurrency_v1"),d=JSON.parse(localStorage.getItem("habitFlowSubsLog_v1")||"[]"),s()):r.style.display="flex",i.addEventListener("click",()=>{l=e.querySelector("#currency-select").value,localStorage.setItem("habitFlowSubsCurrency_v1",l),r.style.display="none",s()}),t.addEventListener("click",()=>{const t=e.querySelector("#sub-name"),n=e.querySelector("#sub-amount"),r=t.value.trim(),i=parseFloat(n.value);r&&i>0?(d.push({id:Date.now(),name:r,amount:i}),localStorage.setItem("habitFlowSubsLog_v1",JSON.stringify(d)),s(),t.value="",n.value=""):alert("Please enter a valid name and amount.")}),o.addEventListener("click",e=>{e.target.classList.contains("btn-delete")&&(d=d.filter(t=>t.id!==parseInt(e.target.dataset.id)),localStorage.setItem("habitFlowSubsLog_v1",JSON.stringify(d)),s())})}
            function initChoresApp(){const e=document.getElementById("app-chores"),t=e.querySelector("#add-chore-btn"),n=e.querySelector("#chore-list-container"),o=e.querySelector("#history-log-chores"),r=e.querySelector("#reward-modal"),i=e.querySelector("#reward-text");let a=JSON.parse(localStorage.getItem("habitFlowChoreList")||"[]"),d=JSON.parse(localStorage.getItem("habitFlowChoreHistory")||"[]");function l(){n.innerHTML="",0===a.length?n.innerHTML='<p style="text-align:center; color: var(--gray);">Add your first chore!</p>':a.forEach(e=>{const t=document.createElement("div");t.className="chore-item",t.innerHTML=`<div class="chore-details"><div class="chore-name">${e.name}</div><div class="chore-reward">Reward: ${e.reward}</div><span class="chore-tag">${e.frequency}</span></div><button class="btn btn-small" data-id="${e.id}" style="font-size: 0.9rem; padding: 0.6rem 1.2rem; width: auto;">Mark as Done</button>`,n.appendChild(t)})}function s(){o.innerHTML="",0===d.length?o.innerHTML='<p style="text-align:center; color: var(--gray);">Completed chores will appear here.</p>':d.slice().reverse().forEach(e=>{const t=document.createElement("div");t.className="history-item",t.innerHTML=`<div style="display:flex; justify-content:space-between;"><span><strong>${e.choreName}</strong> completed</span><span>Reward: ${e.reward}</span></div><div style="font-size:0.8rem;color:var(--gray);text-align:left;">${new Date(e.timestamp).toLocaleString()}</div>`,o.appendChild(t)})}t.addEventListener("click",()=>{const t=e.querySelector("#chore-name-input"),n=e.querySelector("#chore-reward-input"),o=e.querySelector("#chore-freq-select");t.value.trim()&&n.value.trim()?(a.push({id:Date.now(),name:t.value.trim(),reward:n.value.trim(),frequency:o.value}),t.value="",n.value="",localStorage.setItem("habitFlowChoreList",JSON.stringify(a)),l()):alert("Please fill in chore name and reward.")}),n.addEventListener("click",e=>{if("BUTTON"===e.target.tagName&&e.target.dataset.id){const t=parseInt(e.target.dataset.id),n=a.find(e=>e.id===t);n&&(d.push({timestamp:Date.now(),choreName:n.name,reward:n.reward}),localStorage.setItem("habitFlowChoreHistory",JSON.stringify(d)),s(),i.textContent=`You earned: ${n.reward}!`,r.style.display="flex")}}),r.addEventListener("click",()=>r.style.display="none"),l(),s()}
            function initDeclutterApp(){const e=document.getElementById("app-declutter"),t=e.querySelector("#challenge-grid"),n=e.querySelector("#progress-bar"),o=e.querySelector("#progress-text"),r=e.querySelector("#reward-modal-declutter"),i=e.querySelector("#reward-text-declutter"),a=[{day:1,task:"Clear off your kitchen counter.",reward:"Time for a break! Enjoy a warm drink in your clean kitchen."},{day:2,task:"Organize one junk drawer.",reward:"You did it! Play your favorite song."},{day:3,task:"Sort your mail pile.",reward:"Peace of mind. Spend 10 minutes doing nothing at all."},{day:4,task:"Declutter your bedside table.",reward:"Perfect! Light a candle and enjoy the calm."},{day:5,task:"Clean out your wallet or purse.",reward:"Fantastic! Treat yourself to a small coffee or tea."},{day:6,task:"Tidy one shelf on a bookshelf.",reward:"Great work! Read a chapter of a book."},{day:7,task:"Sort through your medicine cabinet.",reward:"Excellent! Take a relaxing 5-minute stretch."},{day:8,task:"Delete old apps from your phone.",reward:"Digitally detoxed! Enjoy your clean home screen."},{day:9,task:"Wipe down your keyboard and screen.",reward:"A clean slate! Browse your favorite websites."},{day:10,task:"Straighten up your entryway.",reward:"Wonderful! Enjoy a welcoming entrance."},{day:11,task:"Declutter the top of your dresser.",reward:"Beautiful! Pick out your favorite outfit for tomorrow."},{day:12,task:"Organize your sock drawer.",reward:"Nicely done! Put on your comfiest pair of socks."},{day:13,task:"Clear one surface in your living room.",reward:"Amazing! Watch a short, fun video."},{day:14,task:"Empty all small trash bins in the house.",reward:"A clean sweep! Enjoy the fresh feeling."},{day:15,task:"Tidy your car's glove compartment.",reward:"Great! Plan a scenic drive for your next trip out."},{day:16,task:"Sort a stack of magazines or papers.",reward:"Productive! Spend 10 minutes learning something new online."},{day:17,task:"Wipe down your kitchen cabinet fronts.",reward:"Sparkling! Admire your handiwork."},{day:18,task:"Organize your cooking spices.",reward:"Delicious! Plan a tasty meal you'd like to cook soon."},{day:19,task:"Clean out the inside of your microwave.",reward:"So satisfying! Heat up a favorite snack or drink."},{day:20,task:"Go through your pens and markers.",reward:"Sharp! Write a short, positive note to yourself."},{day:21,task:"Declutter the area around your TV.",reward:"Picture perfect! Settle in for your favorite show."},{day:22,task:"Straighten the linen closet.",reward:"Neat and tidy! Enjoy the feeling of order."},{day:23,task:"Wipe down bathroom counters and mirror.",reward:"Reflect on a job well done!"},{day:24,task:"Organize your under-sink cabinet.",reward:"Systematic! Appreciate your organized space."},{day:25,task:"Find 5 items to donate.",reward:"Generous! Feel good about giving back."},{day:26,task:"Clear your computer's desktop.",reward:"Digitally detoxed! Enjoy the clean digital workspace."},{day:27,task:"Clean out refrigerator door shelves.",reward:"Cool! Grab a refreshing drink or snack."},{day:28,task:"Match up all your loose socks.",reward:"A perfect pair! Time to relax your feet."},{day:29,task:"Tidy your main workspace.",reward:"Focused! You've created a space for success."},{day:30,task:"Pick one small area and tackle it.",reward:"Challenge Complete! You're a decluttering champion!"}];let d=JSON.parse(localStorage.getItem("habitFlowDeclutterProgress_v2")||"null");function l(){t.innerHTML="";let r=0;d.forEach(i=>{i.completed&&r++;const a=i.day>7,l=document.createElement("div");l.className="day-card",i.completed&&l.classList.add("completed"),a&&l.classList.add("locked"),a&&(l.dataset.locked="true"),l.innerHTML=`<div class="day-header"><span class="day-number">Day ${i.day} ${a?"🔒":""}</span><input type="checkbox" data-day="${i.day}" ${i.completed?"checked disabled":""} ${a?"disabled":""}></div><p class="day-task">${i.task}</p>`,t.appendChild(l)});const i=r/30*100;n.style.width=`${i}%`,o.textContent=`${r}/30 Days Complete`}d&&d.length===a.length||(d=a.map(e=>({...e,completed:!1}))),t.addEventListener("change",e=>{if("checkbox"===e.target.type){const t=parseInt(e.target.dataset.day),n=d.find(e=>e.day===t);n&&!n.completed&&(n.completed=!0,localStorage.setItem("habitFlowDeclutterProgress_v2",JSON.stringify(d)),l(),i.textContent=n.reward,r.style.display="flex")}}),t.addEventListener("click",e=>{e.target.closest(".day-card[data-locked='true']")&&alert("Upgrade to unlock the rest of the challenge!")}),r.addEventListener("click",()=>r.style.display="none"),l()}
            function initHealthApp(){const e=document.getElementById("app-health"),t={SUGAR:{LOW:70,HIGH:180},BP_SYS:{LOW:90,HIGH:180},BP_DIA:{LOW:60,HIGH:120},HR:{LOW:60,HIGH:100},TEMP:{LOW:95,HIGH:103}},n={sugar:e.querySelector("#sugar-input"),bp:e.querySelector("#bp-input"),hr:e.querySelector("#hr-input"),temp:e.querySelector("#temp-input")},o={sugar:e.querySelector("#sugar-warning"),bp:e.querySelector("#bp-warning"),hr:e.querySelector("#hr-warning"),temp:e.querySelector("#temp-warning")};let r=JSON.parse(localStorage.getItem("habitFlowMedList_v5")||"[]"),i=JSON.parse(localStorage.getItem("habitFlowHealthLog_v5")||"[]");function a(){const t=e.querySelector("#med-list-container");t.innerHTML="",r.forEach(e=>{const n=document.createElement("div");n.className="med-tag",n.innerHTML=`${e} <button data-name="${e}">&times;</button>`,t.appendChild(n)})}function d(){const t=e.querySelector("#med-checklist-container");if(t.innerHTML="",r.length>0){const n=document.createElement("h3");n.textContent="Medications Taken Now:",n.style.fontSize="1.1rem",n.style.marginBottom="0.5rem",t.appendChild(n),r.forEach(e=>{const n=document.createElement("label");n.innerHTML=`<input type="checkbox" data-name="${e}"> ${e}`,t.appendChild(n)})}}function l(){const t=e.querySelector("#history-log-health");t.innerHTML="",0===i.length?t.innerHTML="<p>Your saved entries will appear here.</p>":i.slice().reverse().filter(e=>e&&e.timestamp).forEach(e=>{const n=document.createElement("div");n.className="log-item";let o="<strong>Vitals:</strong> ",r=[];e.vitals.sugar&&r.push(`Sugar: ${e.vitals.sugar} mg/dL`),e.vitals.bp&&r.push(`BP: ${e.vitals.bp}`),e.vitals.hr&&r.push(`HR: ${e.vitals.hr} BPM`),e.vitals.temp&&r.push(`Temp: ${e.vitals.temp}°F`),o+=r.length>0?r.join(", "):"Not recorded.";let a="<strong>Medications Taken:</strong>";a+=e.meds&&e.meds.length>0?"<ul>"+e.meds.map(e=>`<li>${e}</li>`).join("")+"</ul>":" None recorded for this entry.",n.innerHTML=`<div class="log-header">${new Date(e.timestamp).toLocaleString()}</div><div class="log-vitals">${o}</div><div class="log-meds">${a}</div>`,t.appendChild(n)})}function s(){const r=parseFloat(n.sugar.value);r?(r<t.SUGAR.LOW?(n.sugar.classList.add("input-warning"),o.sugar.textContent="Low reading. Consult doctor."):r>t.SUGAR.HIGH?(n.sugar.classList.add("input-warning"),o.sugar.textContent="High reading. Consult doctor."):(n.sugar.classList.remove("input-warning"),o.sugar.textContent="")):(n.sugar.classList.remove("input-warning"),o.sugar.textContent="");const i=n.bp.value.split("/");if(2===i.length){const r=parseFloat(i[0]),a=parseFloat(i[1]);r&&(r<t.BP_SYS.LOW||r>t.BP_SYS.HIGH)||a&&(a<t.BP_DIA.LOW||a>t.BP_DIA.HIGH)?(n.bp.classList.add("input-warning"),o.bp.textContent="Range is unusual. Consult doctor."):(n.bp.classList.remove("input-warning"),o.bp.textContent="")}else n.bp.classList.remove("input-warning"),o.bp.textContent="";const a=parseFloat(n.hr.value);a&&a<t.HR.LOW||a>t.HR.HIGH?(n.hr.classList.add("input-warning"),o.hr.textContent="Resting rate unusual. Consult doctor."):(n.hr.classList.remove("input-warning"),o.hr.textContent="");const d=parseFloat(n.temp.value);d&&d<t.TEMP.LOW||d>t.TEMP.HIGH?(n.temp.classList.add("input-warning"),o.temp.textContent="Reading requires attention. Consult doctor."):(n.temp.classList.remove("input-warning"),o.temp.textContent="")}a(),d(),l(),Object.values(n).forEach(e=>e.addEventListener("input",s)),e.querySelector("#add-med-btn-health").addEventListener("click",()=>{const t=e.querySelector("#med-name-input-add");if(t.value.trim()&&!r.includes(t.value.trim()))r.push(t.value.trim()),t.value="",localStorage.setItem("habitFlowMedList_v5",JSON.stringify(r)),a(),d()}),e.querySelector("#med-list-container").addEventListener("click",e=>{e.target.tagName,"BUTTON"===e.target.tagName&&(r=r.filter(t=>t!==e.target.dataset.name),localStorage.setItem("habitFlowMedList_v5",JSON.stringify(r)),a(),d())}),e.querySelector("#save-log-btn-health").addEventListener("click",()=>{const t=[];e.querySelector("#med-checklist-container").querySelectorAll('input[type="checkbox"]:checked').forEach(e=>t.push(e.dataset.name));const o={sugar:n.sugar.value,bp:n.bp.value,hr:n.hr.value,temp:n.temp.value};if(Object.values(o).every(e=>!e)&&0===t.length)return void alert("Please enter at least one vital sign or check a medication to save a record.");const r={timestamp:(new Date).getTime(),vitals:o,meds:t};i.push(r),localStorage.setItem("habitFlowHealthLog_v5",JSON.stringify(i)),Object.values(n).forEach(e=>e.value=""),e.querySelector("#med-checklist-container").querySelectorAll("input:checked").forEach(e=>e.checked=!1),s(),l(),alert("New record has been added to your history!")})}

            App.init();
            // Bind the context for all methods in the App object
            for (const key in App) {
                if (typeof App[key] === 'function') {
                    App[key] = App[key].bind(App);
                }
            }
        });
    </script>
</body>
</html>
